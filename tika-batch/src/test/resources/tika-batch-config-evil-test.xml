<?xml version="1.0" encoding="UTF-8" standalone="no" ?>

<tika-batch-config
        maxAliveTimeSeconds="-1"
        pauseOnEarlyTerminationMillis="500"
        timeoutThresholdMillis="3000"
        timeoutCheckPulseMillis="1000"
        maxTimedOutConsumers="2"
        maxQueueSize="10000"
        numConsumers="3">
    <!-- options to allow on the commandline -->
    <commandline>
        <option opt="bc" longOpt="batch-config" hasArg="true"
                description="xml batch config file" required="true"/>
        <option opt="randomCrawl" hasArg="false"
                description="file crawler crawls directories randomly"/>
        <option opt="numConsumers" hasArg="true"
                description="number of fileConsumers threads"/>
        <option opt="minFileSizeBytes" hasArg="true"
                description="minimum file size to process; do not process files smaller than this"/>
        <option opt="maxFileSizeBytes" hasArg="true"
                description="maximum file size to process; do not process files larger than this"/>
        <option opt="maxTimedOutConsumers" hasArg="true"
                description="maximum number of allowed timed out consumers"/>
        <option opt="maxQueueSize" hasArg="true"
                description="maximum queue size for FileResources"/>
        <option opt="fileList" hasArg="true"
                description="file that contains a list of files (relative to srcDir) to process"/>
        <option opt="fileListEncoding" hasArg="true"
                description="encoding for fileList"/>
        <option opt="srcDir" hasArg="true"
                description="root directory for the files to be processed"
                required="true"/>
        <option opt="startDir" hasArg="true"
                description="directory (under srcDir) at which to start crawling"/>
        <option opt="targDir" hasArg="true"
                description="target directory for output"
                required="true"/>
        <option opt="recursiveParserWrapper"
                description="use the RecursiveParserWrapper or not (default = false)"/>
        <option opt="handleExisting" hasArg="true"
                description="if a target file already exists, do you want to: overwrite, rename or skip"/>
        <option opt="basicHandlerType" hasArg="true"
                description="what type of content handler: xml, text, html, body"/>
        <option opt="targetSuffix" hasArg="true"
                description="suffix to add to the end of the target file name"/>
        <option opt="timeoutThresholdMillis" hasArg="true"
                description="how long to wait before determining that a consumer should be timed out"/>
        <option opt="pauseOnEarlyTerminationMillis" hasArg="true"
                description="how long to wait for parsers to finish if there is an early termination from the main loop."/>
        <!-- in long running process, might be good to restart every hour or so to avoid memory leaks-->
        <option opt="maxAliveTimeSeconds" hasArg="true"
                description="how long should this process run in seconds."/>
    </commandline>
    <!--
        Can also add startDir: this tells the crawler to start indexing a
        child directory of the srcDir directory.
    -->
	<crawler builderClass="org.apache.tika.batch.fs.builders.FSCrawlerBuilder"
        crawlOrder="sorted"
        maxConsecWaitMillis="5000"
        maxFilesToAdd="-1"
		maxFilesToConsider="-1" 
		includeFilePat=""
		excludeFilePat=""
		maxFileSizeBytes="-1"
        srcDir="tika-batch/src/test/resources/test-input"
        />

	<consumers builderClass="org.apache.tika.batch.fs.builders.BasicTikaFSConsumersBuilder"
               recursiveParserWrapper="false">
		<parser class="org.apache.tika.parser.evil.EvilParserFactory" parseRecursively="true"/>
		<contenthandler builderClass="org.apache.tika.batch.builders.DefaultContentHandlerFactoryBuilder"
                        basicHandlerType="xml" writeLimit="-1"/>
		
		<!-- overwritePolicy: "skip" a file if target file exists, "rename" a target file, "overwrite" -->
		<outputstream class="FSOutputStreamFactory" handleExisting="skip" targDir="output"
                encoding="UTF-8" targetSuffix="xml"/>
	</consumers>
	
	<!-- reporter and interrupter are optional -->
	<reporter builderClass="org.apache.tika.batch.builders.SimpleLogReporterBuilder" sleepMillis="1000"
              reporterStaleThresholdMillis="500000"/>
	<interrupter builderClass="org.apache.tika.batch.builders.CommandLineInterrupterBuilder"/>
</tika-batch-config>